# Основной конфигурационный файл Alembic.
# Здесь настраивается, где лежат миграции, как подключаться к базе
# и как вести логи.

[alembic]
# Путь к папке с миграциями.
# %(here)s — это папка, где находится этот файл alembic.ini.
script_location = %(here)s/migrations

# Шаблон имён файлов миграций.
# По умолчанию используется формат "<ревизия>_<короткое_описание>".
# Можно раскомментировать пример ниже, чтобы добавить дату/время в имя файла.
# Подробнее: документация Alembic.
# file_template = %%(year)d_%%(month).2d_%%(day).2d_%%(hour).2d%%(minute).2d-%%(rev)s_%%(slug)s

# Дополнительные пути, которые будут добавлены в sys.path.
# По умолчанию используется текущая рабочая директория.
prepend_sys_path = .

# Настройка разделителя путей для нескольких директорий (для version_locations и др.).
# Значение "os" означает, что используется стандартный разделитель ОС (например, ":" или ";").
path_separator = os

# Таймзона, которая будет использоваться для времени в миграциях и именах файлов.
# Если оставить пустым, будет использоваться локальное время системы.
# Для использования таймзон нужно установить пакет tzdata и alembic[tz].
# timezone =

# Максимальная длина "slug" (короткого текстового описания) в имени файла миграции.
# truncate_slug_length = 40

# Если установить true, Alembic будет выполнять env.py при создании ревизии (revision),
# даже если не используется автогенерация.
# revision_environment = false

# Разрешить ли искать версии миграций по .pyc/.pyo без исходников .py.
# sourceless = false

# Дополнительные директории версий миграций (если нужно несколько путей).
# version_locations = %(here)s/bar:%(here)s/bat:%(here)s/alembic/versions

# Включать ли рекурсивный обход подпапок в version_locations.
# recursive_version_locations = false

# Кодировка, в которой будут записаны файлы миграций.
# Обычно utf-8 достаточно.
# output_encoding = utf-8


# Строка подключения к базе данных.
# ВАЖНО:
# - Этот URL фактически используется только в env.py.
# - В нашем проекте настоящий URL подставляется из Python-кода
#   (app.config.settings.database_url).
# - Здесь оставляем безопасную заглушку, чтобы Alembic не ругался.
sqlalchemy.url = sqlite:///./dummy.db


[post_write_hooks]
# post_write_hooks — это хуки, которые можно запускать после создания файла миграции.
# Например, можно автоматически форматировать код (black) или запускать линтер (ruff).
# По умолчанию ничего не включено.

# Пример использования black:
# hooks = black
# black.type = console_scripts
# black.entrypoint = black
# black.options = -l 79 REVISION_SCRIPT_FILENAME

# Пример использования ruff:
# hooks = ruff
# ruff.type = module
# ruff.module = ruff
# ruff.options = check --fix REVISION_SCRIPT_FILENAME


# Ниже — стандартная настройка логирования для Alembic и SQLAlchemy.
# Это нужно, чтобы видеть аккуратные сообщения в консоли при миграциях.

[loggers]
# Список логгеров, которые мы настраиваем: общий (root),
# логгер SQLAlchemy и логгер Alembic.
keys = root,sqlalchemy,alembic

[handlers]
# Обработчики логов — здесь только вывод в консоль.
keys = console

[formatters]
# Формат сообщений логов.
keys = generic

[logger_root]
# Общий логгер (root logger): уровень WARNING, вывод в консоль.
level = WARNING
handlers = console
qualname =

[logger_sqlalchemy]
# Логгер для SQLAlchemy (SQL-запросы и т.п.).
level = WARNING
handlers =
qualname = sqlalchemy.engine

[logger_alembic]
# Логгер для Alembic (информация о миграциях).
level = INFO
handlers =
qualname = alembic

[handler_console]
# Обработчик, который выводит логи в стандартный поток ошибок (консоль).
class = StreamHandler
args = (sys.stderr,)
level = NOTSET
formatter = generic

[formatter_generic]
# Формат строки логов: уровень, имя логгера и сообщение.
format = %(levelname)-5.5s [%(name)s] %(message)s
datefmt = %H:%M:%S
